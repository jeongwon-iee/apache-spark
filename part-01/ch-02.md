# Part 1. 빅데이터와 스파크 간단히 살펴보기

### 목차

- Chapter 2. 스파크 간단히 살펴보기
  - 2.1 스파크의 기본 아키텍처
  - 2.2 스파크의 다양한 언어 API
  - 2.3 스파크의 API
  - 2.4 스파크 시작하기
  - 2.5 SparkSession
  - 2.6 DataFrame
  - 2.7 트랜스포메이션
  - 2.8 액션
  - 2.9 스파크 UI
  - 2.10 종합 예제
  - 2.11 정리
 
&nbsp;

## Chapter 2. 스파크 간단히 살펴보기

1장에서는 아파치 스파크의 역사를 살펴보았다. 이제 스파크를 사용해보려고 한다.  

이 장에서는 DataFrame과 SQL을 사용해 클러스터, 스파크 애플리케이션 그리고 구조적 API를 살펴볼 것이다.  
이 과정에서 **스파크의 핵심 용어와 개념**을 접하고 사용법을 익힐 것이다.

&nbsp;

### 2.1 스파크의 기본 아키텍처

#### 대용량 데이터 처리를 위한 클러스터와 클러스터를 관리하는 프레임워크 Spark

한 대의 컴퓨터(집이나 직장 책상 위에 놓인 장비 한 대)로는 대규모 정보를 연산할 만한 자원이나 성능을 가지지 못해 데이터 처리가 힘들다.  

컴퓨터 **클러스터**는 여러 컴퓨터의 자원을 모아 하나의 컴퓨터처럼 사용할 수 있게 만든다.  
하지만 컴퓨터 클러스터를 구성하는 것만으로는 부족, 클러스터에서 작업을 조율할 수 있는 프레임워크가 필요하다.  
스파크가 이런 역할을 하는 프레임워크다.

**스파크는 클러스터의 데이터 처리 작업을 관리하고 조율한다.**  
스파크가 연산에 사용하는 클러스터는 스파크 standalone 클러스터 매니저, 하둡 YARN, Mesos 같은 *클러스터 매니저* 에서 관리한다.  

사용자는 클러스터 매니저에 스파크 애플리케이션을 제출(submit)하고,  
이를 제출 받은 클러스터 매니저는 애플리케이션 실행에 필요한 자원을 할당하며, 우리는 할당받은 자원으로 작업을 처리한다.

#### 2.1.1 스파크 애플리케이션

스파크 애플리케이션은 **드라이버**(driver) 프로세스와 다수의 **익스큐터**(executor) 프로세스로 구성된다.  
- 드라이버 프로세스
  - 클러스터 노드 중 하나에서 실행되며, `main()` 함수를 실행한다.
  - 스파크 애플리케이션 정보의 유지 관리
  - 사용자 프로그램이나 입력에 대한 응답
  - 전반적인 익스큐터 프로세스의 작업과 관련된 분석, 배포, 그리고 스케쥴링 역할을 수행
  - 애플리케이션의 수명 주기 동안 관련 정보를 모두 유지
- 익스큐터 프로세스
  - 드라이버 프로세스가 할당한 작업을 수행한다.
  - 드라이버가 할당한 코드를 실행하고, 진행 상황을 다시 드라이버 노드에 보고하는 두 가지 역할을 수행한다.

<img width="428" alt="스크린샷 2022-01-23 오후 5 37 32" src="https://user-images.githubusercontent.com/45806836/150670862-d0ffe99d-c932-4a72-ba5c-f7c708dc54bb.png">

위 그림은 클러스터 매니저가 물리적 머신을 관리하고 스파크 애플리케이션에 자원을 할당하는 방법을 나타낸다.

클러스터 매니저는 스파크 standalone 클러스터 매니저, 하둡 YARN, 혹은 Mesos 중 하나를 선택할 수 있으며,  
하나의 클러스터에서 여러 개의 스파크 애플리케이션을 실행할 수 있다.  
사용자는 각 노드에 할당할 익스큐터 수를 지정할 수 있다.

*참고*  
스파크는 클러스터 모드뿐 아니라 **로컬 모드**도 지원한다.  
드라이버와 익스큐터는 단순한 프로세스이므로 같은 머신이나 서로 다른 머신에서 실행할 수 있다.  
하지만 로컬 모드로 실행하면 드라이버와 익스큐터를 단일 머신에서 스레드 형태로 실행한다.

#### 정리

- 스파크는 사용 가능한 자원을 파악하기 위해 클러스터 매니저를 사용한다.
- 드라이버 프로세스는 주어진 작업을 완료하기 위해 드라이버 프로그램의 명령을 익스큐터 프로세스에서 실행한다.

&nbsp;

### 2.2 스파크의 다양한 언어 API

스파크의 언어 API를 사용하면 다양한 프로그래밍 언어로 스파크 코드를 실행할 수 있다.  
스파크는 모든 언어에 맞는 몇몇 '핵심 개념'을 제공하며, 이러한 핵심 개념은 클러스터 머신에서 실행되는 스파크 코드로 변환된다.  
구조적 API만으로 작성된 코드는 언어에 사오간없이 유사한 성능을 발휘한다.

#### 스칼라

스파크는 스칼라로 개발되어 있으므로 스칼라가 스파크의 기본 언어다.

#### 자바

스파크가 스칼라로 개발되어 있지만, 스파크 창시자들은 자바를 이용해 스파크 코드를 작성할 수 있도록 심혈을 기울였다고 한다.

#### SQL

스파크는 ANSI SQL:2003 표준 중 일부를 지원한다.

#### SparkSession과 스파크 언어 API의 관계

<img width="555" alt="스크린샷 2022-01-23 오후 6 22 33" src="https://user-images.githubusercontent.com/45806836/150672231-cb59e9b3-c96b-49f4-91ef-a5948b33227b.png">

각 
